<html>
<head>
<title>ADS redirector</title>
</head>
<body>

<h1>ADS redirector</h1>

<h3>Examples:</h3>
<script lang="text/javascript">

function getADSquery(arg) {
  year = /\([0-9]{4}\)/.exec(arg);
  if (!year) {
    year = / [0-9]{4}/.exec(arg);
  }
  if (!year) {
    year = /[0-9]{4}/.exec(arg);
  }
  var query = "";
  if (year) {
    arg = arg.replace(year[0], "").trim()
    query = query + " year:" + year[0].replace("(","").replace(")","");
  }
  arg = arg.replace("et al.", "").replace("et al", "").replace("+", "").trim().trim(",").trim();
  var authors = arg.split("/&,/");
  for (var i = 0; i < authors.length; i++) {
    if (authors[i] && authors[i].trim().length > 0) {
      if(i == 0) {
         query = query + ' author:"^' + authors[i] + '"';
      } else {
         query = query + ' author:"' + authors[i] + '"';
      }
    }
  }
  
  return "https://ui.adsabs.harvard.edu/search/q=" + encodeURIComponent(query.trim());
}

var testqueries = [
  "Buchner et al. (2017)",
  "Buchner (2014)",
  "Baloković et al (2018)",
  "Baloković et al., 2018",
  "Brightman+2018",
  "Brightman et al 2010",
];
for(var i = 0; i < testqueries.length; i++) {
   var query = testqueries[i];
   document.write("<p>" + query + " --&gt; <a href='" + getADSquery(query) + "'>link</a></p>");
}
</script>

<form>
<input type="text" name="q" />
<input type="submit" value="Submit" />
</form>


<script>
var url = location.search;
if (url.startsWith("?q=")) {
   url = getADSquery(decodeURIComponent(url.substr(3).replace(/\+/g, ' ')));
   document.write("<p>Redirecting to <a href='" + url + "'>corresponding ADS query</a></p>");
   window.location.replace(url);
}

</script>

</html>

