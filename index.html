<!doctype html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<title>ADS search by reference</title>
<script lang="text/javascript">

function getADSquery(arg) {
  year = /\([0-9]{4}\)/.exec(arg);
  if (!year) {
    year = / [0-9]{4}/.exec(arg);
  }
  if (!year) {
    year = /[0-9]{4}/.exec(arg);
  }
  var query = "";
  if (year) {
    arg = arg.replace(year[0], "").trim()
    query = query + " year:" + year[0].replace("(","").replace(")","");
  }
  arg = arg.replace("et al.", "").replace("et al", "").replace("+", "").trim().trim(",").trim();
  var authors = arg.split("/&,/");
  for (var i = 0; i < authors.length; i++) {
    if (authors[i] && authors[i].trim().length > 0) {
      if(i == 0) {
         query = query + ' author:"^' + authors[i] + '"';
      } else {
         query = query + ' author:"' + authors[i] + '"';
      }
    }
  }
  
  return "https://ui.adsabs.harvard.edu/search/q=" + encodeURIComponent(query.trim());
}

var testqueries = [
  "Buchner et al. (2017)",
  "Buchner (2014)",
  "Baloković et al (2018)",
  "Baloković et al., 2018",
  "Brightman+2018",
  "Brightman et al 2010",
];
</script>

</head>
<body>

<h1>ADS search by reference</h1>

<p>Searches the <a href="https://ui.adsabs.harvard.edu/search/">new ADS</a> by Lastname (year) reference strings.</p>

<form>
<input type="text" name="q" />
<input type="submit" value="Look up in ADS" />
</form>

<ol>
	<li>Right-click the field</li>
	<li>"Add a Keyword for this Search"</li>
	<li>Set the keyword to ADS</li>
	<li>Done! Enter into your search bar "ads Lastname et al. (2017)" (without quotes)</li>
</ol>

<script>
var url = location.search;
if (url.startsWith("?q=")) {
   url = getADSquery(decodeURIComponent(url.substr(3).replace(/\+/g, ' ')));
   document.write("<p>Redirecting to <a href='" + url + "'>corresponding ADS query</a></p>");
   window.location.replace(url);
} else {
   document.write("<h3>Examples:</h3><ul>");
   for(var i = 0; i < testqueries.length; i++) {
       var query = testqueries[i];
       document.write("<li>&quot;" + query + "&quot; &rarr; <a href='" + getADSquery(query) + "'>link</a></li>");
   }
   document.write("</ul>")
}

</script>

</html>

